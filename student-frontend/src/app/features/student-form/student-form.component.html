<!-- src/app/features/student-form/student-form.component.html -->
<div class="container py-4">
  <div class="card shadow-sm border-0">
    <div class="card-header bg-light text-center py-3">
      <h2 class="mb-0 h4 d-flex align-items-center justify-content-center">
        <lucide-icon
          [name]="isEditMode ? 'edit-3' : 'user-plus'"
          size="26"
          class="me-2"
        ></lucide-icon>
        {{ isEditMode ? "Edit Student Details" : "Add New Student" }}
      </h2>
    </div>

    <div class="card-body p-4 p-md-5">
      <form [formGroup]="studentForm" (ngSubmit)="onSubmit()" novalidate>
        <div class="row g-4">
          <!-- Required Fields Section -->
          <div class="col-md-6">
            <label for="name" class="form-label"
              >Name <span class="text-danger">*</span></label
            >
            <input
              type="text"
              id="name"
              class="form-control"
              formControlName="name"
              [ngClass]="{
                'is-invalid':
                  studentForm.get('name')?.invalid &&
                  studentForm.get('name')?.touched
              }"
            />
            <div
              *ngIf="
                studentForm.get('name')?.invalid &&
                studentForm.get('name')?.touched
              "
              class="invalid-feedback"
            >
              Name is required and must contain valid characters.
            </div>
          </div>
          <div class="col-md-6">
            <label for="email" class="form-label"
              >Email <span class="text-danger">*</span></label
            >
            <input
              type="email"
              id="email"
              class="form-control"
              formControlName="email"
              [ngClass]="{
                'is-invalid':
                  studentForm.get('email')?.invalid &&
                  studentForm.get('email')?.touched
              }"
            />
            <div
              *ngIf="
                studentForm.get('email')?.invalid &&
                studentForm.get('email')?.touched
              "
              class="invalid-feedback"
            >
              A valid email is required.
            </div>
          </div>
          <div class="col-md-6">
            <label for="mobile" class="form-label"
              >Mobile <span class="text-danger">*</span></label
            >
            <input
              type="tel"
              id="mobile"
              class="form-control"
              formControlName="mobile"
              [ngClass]="{
                'is-invalid':
                  studentForm.get('mobile')?.invalid &&
                  studentForm.get('mobile')?.touched
              }"
            />
            <div
              *ngIf="
                studentForm.get('mobile')?.invalid &&
                studentForm.get('mobile')?.touched
              "
              class="invalid-feedback"
            >
              A valid 10-digit mobile number is required.
            </div>
          </div>
          <div class="col-md-6">
            <label for="course" class="form-label"
              >Course <span class="text-danger">*</span></label
            >
            <select
              id="course"
              class="form-select"
              formControlName="course"
              [ngClass]="{
                'is-invalid':
                  studentForm.get('course')?.invalid &&
                  studentForm.get('course')?.touched
              }"
            >
              <option [ngValue]="null">-- Select a course --</option>
              <option
                *ngFor="let course of courseOptions"
                [ngValue]="course.value"
              >
                {{ course.label }}
              </option>
            </select>

            <div
              *ngIf="
                studentForm.get('course')?.invalid &&
                studentForm.get('course')?.touched
              "
              class="invalid-feedback d-block"
            >
              Course is required.
            </div>
          </div>

          <!-- Optional Fields Section -->
          <div class="col-md-6">
            <label for="country" class="form-label">Country</label>
            <select
              id="country"
              formControlName="country"
              class="form-select"
             [ngClass]="{
           'is-invalid':
                  studentForm.get('country')?.invalid &&
                  studentForm.get('country')?.touched
             }"
            >
            <option [ngValue]="null">-- Select a Country --</option>
              <option
                *ngFor="let country of countryOptions"
                [ngValue]="country.value"
              >
                {{ country.label }}
              </option>
        </select>
          </div>
          <div class="col-md-6">
            <label for="state" class="form-label">State</label>
              <select
              id="state"
              formControlName="state"
              class="form-select"
             [ngClass]="{
           'is-invalid':
                  studentForm.get('state')?.invalid &&
                  studentForm.get('state')?.touched
             }"
            >
            <option [ngValue]="null">-- Select a State --</option>
              <option
                *ngFor="let state of stateOptions"
                [ngValue]="state.value"
              >
                {{ state.label }}
              </option>
        </select>
          </div>
          <div class="col-md-6">
            <label for="city" class="form-label">City</label>
            <input
              type="text"
              id="city"
              class="form-control"
              formControlName="city"
            />
          </div>
          <div class="col-md-6">
            <label for="address" class="form-label">Address</label>
            <input
              type="text"
              id="address"
              class="form-control"
              formControlName="address"
            />
          </div>
          <div class="col-12">
            <label for="about_student" class="form-label">About Student</label>
            <textarea
              id="about_student"
              class="form-control"
              formControlName="about_student"
              rows="3"
            ></textarea>
          </div>

          <!-- Image Upload Section -->
          <div class="col-12">
            <label for="image" class="form-label">Student Image</label>
            <div *ngIf="!imagePreview">
              <input
                type="file"
                id="image"
                class="form-control"
                (change)="onFileSelected($event)"
                accept="image/png, image/jpeg, image/gif"
              />
            </div>
            <div
              *ngIf="imagePreview"
              class="mt-2 position-relative d-inline-block"
            >
              <img
                [src]="imagePreview"
                alt="Student Preview"
                class="rounded"
                style="max-height: 100px; max-width: 100%"
              />
              <button
                type="button"
                class="btn btn-danger btn-sm rounded-circle position-absolute top-0 start-100 translate-middle p-0"
                style="width: 1.5rem; height: 1.5rem"
                (click)="removeImage()"
              >
                Ã—
              </button>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="d-flex justify-content-end mt-4 pt-3 border-top">
          <button
            type="button"
            class="btn btn-outline-secondary me-2 px-4"
            (click)="onCancel()"
            [disabled]="isLoading"
          >
            Cancel
          </button>
          <button
            type="submit"
            class="btn btn-primary px-4"
            [disabled]="isLoading"
          >
            <span
              *ngIf="isLoading"
              class="spinner-border spinner-border-sm me-2"
            ></span>
            {{
              isLoading
                ? isEditMode
                  ? "Saving..."
                  : "Submitting..."
                : isEditMode
                ? "Save Changes"
                : "Submit Student"
            }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
